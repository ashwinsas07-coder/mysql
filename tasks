Task 1: Find Top-Selling Product
Write a query to display the top 5 products based on total sales amount.
Include: product_name, total_sales, total_quantity.

SELECT 
product AS product_name,
SUM(Sales) AS total_sales,
SUM(Quantity) AS total_quantity
FROM ecm.book12
GROUP BY product
ORDER BY total_sales DESC
LIMIT 5;

Task 2: Customer Purchase Summary
For each customer, show:
* Total orders
* Total sales
* Average discount
  Only include customers who have placed more than 3 orders.

SELECT 
`Customer Name`,
COUNT(`Order ID`) AS total_orders,
SUM(`Sales`) AS total_sales,AVG(`Discount`) AS average_discount
FROM ecm.book12
GROUP BY `Customer Name`
HAVING COUNT(`Order ID`) > 3;

Task 3: Orders With Higher Shipping Cost
Fetch all orders where the shipping cost is above the average shipping cost of all orders.
Show: order_id, product_name, shipping_cost.

SELECT
 `Order ID`,
`Product`,
`Shipping Cost`
FROM ecm.book12
WHERE `Shipping Cost` >(SELECT AVG(`Shipping Cost`) FROM ecm.book12);

Task 4: Region-Wise Monthly Sales
Display the total monthly sales for each region.
Output columns: region, month_name, total_sales
Sort by region and month.

SELECT
Region,
MONTHNAME(`Order Date`) AS month_name,
SUM(Sales) AS total_sales
FROM ecm.book12
GROUP BY
Region,
MONTH(`Order Date`),
MONTHNAME(`Order Date`)
ORDER BY
Region,
MONTH(`Order Date`);

Task 5: Identify Delayed Shipments
Find all orders where the shipment took more days than the average aging across all orders.
Show: order_id, aging, ship_mode, city, customer_name.

SELECT * FROM ecm.book12;

SELECT
`Order ID` AS order_id,
Aging,
`Ship Mode` AS ship_mode,
City,
`Customer Name` AS customer_name
FROM ecm.book12
WHERE Aging > (SELECT AVG(Aging) FROM ecm.book12);

join task sql question
1.Get total sales amount per product per day
select *from data_d;
select * from inventory;
select * from products;
select * from sales;
select * from store;

SELECT 
s.Date,
s.Product_ID,
p.Product_Name,
SUM(s.Units * p.Product_Price) AS Total_Sales_Amount
FROM sales s
JOIN products p ON s.Product_ID = p.Product_ID
GROUP BY s.Date, s.Product_ID, p.Product_Name
ORDER BY s.Date, s.Product_ID;
