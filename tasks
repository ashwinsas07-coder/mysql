Task 1: Find Top-Selling Product
Write a query to display the top 5 products based on total sales amount.
Include: product_name, total_sales, total_quantity.

SELECT 
product AS product_name,
SUM(Sales) AS total_sales,
SUM(Quantity) AS total_quantity
FROM ecm.book12
GROUP BY product
ORDER BY total_sales DESC
LIMIT 5;

Task 2: Customer Purchase Summary
For each customer, show:
* Total orders
* Total sales
* Average discount
  Only include customers who have placed more than 3 orders.


SELECT 
`Customer Name`,
COUNT(`Order ID`) AS total_orders,
SUM(`Sales`) AS total_sales,AVG(`Discount`) AS average_discount
FROM ecm.book12
GROUP BY `Customer Name`
HAVING COUNT(`Order ID`) > 3;

Task 3: Orders With Higher Shipping Cost
Fetch all orders where the shipping cost is above the average shipping cost of all orders.
Show: order_id, product_name, shipping_cost.

SELECT
 `Order ID`,
`Product`,
`Shipping Cost`
FROM ecm.book12
WHERE `Shipping Cost` >(SELECT AVG(`Shipping Cost`) FROM ecm.book12);

Task 4: Region-Wise Monthly Sales
Display the total monthly sales for each region.
Output columns: region, month_name, total_sales
Sort by region and month.

SELECT
Region,
MONTHNAME(`Order Date`) AS month_name,
SUM(Sales) AS total_sales
FROM ecm.book12
GROUP BY
Region,
MONTH(`Order Date`),
MONTHNAME(`Order Date`)
ORDER BY
Region,
MONTH(`Order Date`);

Task 5: Identify Delayed Shipments
Find all orders where the shipment took more days than the average aging across all orders.
Show: order_id, aging, ship_mode, city, customer_name.

SELECT * FROM ecm.book12;

SELECT
`Order ID` AS order_id,
Aging,
`Ship Mode` AS ship_mode,
City,
`Customer Name` AS customer_name
FROM ecm.book12
WHERE Aging > (SELECT AVG(Aging) FROM ecm.book12);

join task sql question
1.Get total sales amount per product per day
select *from data_d;
select * from inventory;
select * from products;
select * from sales;
select * from store;

SELECT 
s.Date,
s.Product_ID,
p.Product_Name,
SUM(s.Units * p.Product_Price) AS Total_Sales_Amount
FROM sales s
JOIN products p ON s.Product_ID = p.Product_ID
GROUP BY s.Date, s.Product_ID, p.Product_Name
ORDER BY s.Date, s.Product_ID;

2.Find products that are in inventory but have zero sales
SELECT 
i.Product_ID,
p.Product_Name
FROM inventory i
LEFT JOIN sales s ON i.Product_ID = s.Product_ID
JOIN products p ON i.Product_ID = p.Product_ID
WHERE s.Product_ID IS NULL;

3.Get store-wise monthly sales summary
SELECT  
    s.Store_ID,
    st.Store_Name,
    YEAR(s.Date) AS Sales_Year,
    MONTH(s.Date) AS Sales_Month,
    DATE_FORMAT(MIN(s.Date), '%b') AS Month_Name,
    SUM(s.Units * p.Product_Price) AS Total_Sales_Amount
FROM sales s
JOIN products p ON s.Product_ID = p.Product_ID
JOIN store st ON s.Store_ID = st.Store_ID
GROUP BY s.Store_ID,st.Store_Name,YEAR(s.Date),MONTH(s.Date)
ORDER BY s.Store_ID,Sales_Year,Sales_Month;


4.show all stores and their product categories sold
SELECT
st.Store_ID,
st.Store_Name,
p.Product_Category
FROM sales s
JOIN store st ON s.Store_ID = st.Store_ID
JOIN products p ON s.Product_ID = p.Product_ID
GROUP BY st.Store_ID,st.Store_Name,p.Product_Category
ORDER BY st.Store_ID,p.Product_Category;

5.calculate inventory turnover per product
SELECT 
    p.Product_ID,
    p.Product_Name,
    SUM(s.Units) AS Total_Units_Sold,
    inv.total_stock AS Stock_On_Hand,

    CASE 
        WHEN inv.total_stock = 0 THEN NULL
        ELSE ROUND(SUM(s.Units) / inv.total_stock, 2)
    END AS Inventory_Turnover

FROM products p

LEFT JOIN sales s
    ON p.Product_ID = s.Product_ID

LEFT JOIN (
    SELECT 
        Product_ID,
        SUM(Stock_On_Hand) AS total_stock
    FROM inventory
    GROUP BY Product_ID
) inv
    ON p.Product_ID = inv.Product_ID

GROUP BY
    p.Product_ID,
    p.Product_Name,
    inv.total_stock

ORDER BY Inventory_Turnover DESC;
